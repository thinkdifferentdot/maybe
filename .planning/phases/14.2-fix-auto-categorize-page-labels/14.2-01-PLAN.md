---
phase: 14.2-fix-auto-categorize-page-labels
plan: 01
type: execute
domain: rails
---

<objective>
Fix missing option labels on auto-categorization settings page.

Purpose: The toggle component receives label text but doesn't display it, causing the three AI categorization options to appear without their descriptive labels ("Categorize on CSV import", "Categorize on account sync", "Categorize on manual action").
Output: DS::Toggle component supports and displays label text.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@app/helpers/styled_form_builder.rb
@app/components/DS/toggle.rb
@app/components/DS/toggle.html.erb
@app/views/settings/auto_categorization/show.html.erb
@config/locales/views/settings/auto_categorization/en.yml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add label attribute to DS::Toggle component</name>
  <files>app/components/DS/toggle.rb</files>
  <action>Add `label` as an initializer attribute. Add it to `attr_reader` list. Initialize with default `nil` in the `initialize` method params. This allows the component to receive and store the label text passed from styled_form_builder.rb.</action>
  <verify>grep "attr_reader :label" app/components/DS/toggle.rb returns the attribute declaration</verify>
  <done>DS::Toggle accepts label parameter and stores it as @label</done>
</task>

<task type="auto">
  <name>Task 2: Update toggle template to display label text</name>
  <files>app/components/DS/toggle.html.erb</files>
  <action>Replace the hardcoded `&nbsp;` with a conditional that uses `label` if provided, falls back to `&nbsp;` if nil. Use `<%= label || "&nbsp;".html_safe %>` as the label_tag content. Wrap the toggle div and label text in a flex container for proper alignment.</action>
  <verify>grep "label ||" app/components/DS/toggle.html.erb shows the conditional label rendering</verify>
  <done>Toggle displays label text when provided, renders as flex-aligned switch + text</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `bin/rails test` passes (no regressions in toggle component tests)
- [ ] Visit /settings/auto_categorization and verify all three toggles show their labels
- [ ] Labels appear: "Categorize on CSV import", "Categorize on account sync", "Categorize on manual action"
</verification>

<success_criteria>

- DS::Toggle component accepts and stores label attribute
- Toggle template renders label text instead of &nbsp; when label is provided
- All three auto-categorization options display their descriptive labels
- No regressions to other toggle usages in the app
  </success_criteria>

<output>
After completion, create `.planning/phases/14.2-fix-auto-categorize-page-labels/14.2-01-SUMMARY.md`:

# Phase 14.2 Plan 1: Fix Auto-Categorize Page Labels Summary

**Fixed missing toggle labels on auto-categorization settings page by adding label support to DS::Toggle component.**

## Accomplishments

- Added label attribute to DS::Toggle component
- Updated toggle.html.erb template to render label text conditionally
- All three AI categorization options now display their descriptive labels

## Files Created/Modified

- `app/components/DS/toggle.rb` - Added label to attr_reader and initialize params
- `app/components/DS/toggle.html.erb` - Changed from hardcoded &nbsp; to conditional label rendering

## Decisions Made

Used conditional rendering (`label || "&nbsp;".html_safe`) to maintain backward compatibility with existing toggle usages that don't provide a label.

## Issues Encountered

None.

## Next Step

Phase 14.2 complete, ready for next phase or continued manual testing.
</output>
